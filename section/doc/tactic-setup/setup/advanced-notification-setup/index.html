<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.8" />
<title></title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}


#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install();
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="_advanced_notification_setup">Advanced Notification Setup</h2>
<div class="sectionbody">
<div class="paragraph"><p>The notification view is located in the TACTIC Sidebar under:</p></div>
<div class="paragraph"><p><strong>Site Admin &#8594; Notifications</strong></p></div>
<div class="paragraph"><p>This can also be accessed through the <strong>Workflow Editor</strong>, by right
clicking on a node and selecting from the context menu <strong>Show
Triggers/Notifications</strong>.</p></div>
<div class="paragraph"><p>This view provides all the functionality required to set up the various
types of notifications used to establish better production communication
and instant status updates.</p></div>
<div class="paragraph"><p><span class="image">
<img src="media/1_advanced_notification_setup_overview.png" alt="image" />
</span></p></div>
<div class="paragraph"><p><strong>Insert Notifications</strong></p></div>
<div class="paragraph"><p>To insert a new notification, select from the sidebar:</p></div>
<div class="paragraph"><p><strong>Site Admin &#8594; Notifications</strong></p></div>
<div class="paragraph"><p>The following table explains the basic usage of each property.</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="17%" />
<col width="83%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><strong>Event</strong></p></td>
<td align="left" valign="top"><p class="table">The TACTIC event to execute the notification for</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Project Code</strong></p></td>
<td align="left" valign="top"><p class="table">The project code for the notification. This allows for
filtering of notifications for a specific project</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Type</strong></p></td>
<td align="left" valign="top"><p class="table">The type of notification being sent. By default for
notifications, this must be set to "email"</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Search Type</strong></p></td>
<td align="left" valign="top"><p class="table">The search type attribute identifies the parent sType if
the event is for a task, note, or snapshot. It used to be achived by
adding a rule as in Example 2.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Mail_to</strong></p></td>
<td align="left" valign="top"><p class="table">An expression of the users to mail to in the email (supports
multiple lines of expressions and / or email addresses and names of
groups of users made in TACTIC)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Mail_cc</strong></p></td>
<td align="left" valign="top"><p class="table">An expression of the users to mail to in the email. It will
appear in the cc category. (supports multiple lines of expressions and /
or email addresses and groups)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Mail_bcc</strong></p></td>
<td align="left" valign="top"><p class="table">An expression of the users to mail to in the email. It will
appear in the bcc category. (supports multiple lines of expressions and
/ or email addresses and groups)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p><strong>Note:</strong> The default is to email the person that causes the notification
to fire through the event set up. To turn off this behavior, you can add
an entry in Project Setting: key = email_to_sender , value = false.</p></div>
<div class="paragraph"><p>Below are examples of what can be used in <em>mail_to</em>, <em>mail_cc</em>, or
<em>mail_bcc</em>:</p></div>
<div class="paragraph"><p>For example, email the user <em>admin</em> only:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>@SOBJECT(sthpw/login['login', 'admin'])</code></pre>
</div></div>
<div class="paragraph"><p>For example, send to the user related to this sObject. If this is an
event for task update, the email will be addressed to the assigned user:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>@SOBJECT(sobject.sthpw/login)</code></pre>
</div></div>
<div class="paragraph"><p>If it is already a task for the event update|sthpw/task, which contains
the assigned or supervisor attribute, the email will be addressed to
both by just retrieving these attributes in two lines.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>@GET(sobject.assigned)
@GET(sobject.supervisor)</code></pre>
</div></div>
<div class="paragraph"><p>Let&#8217;s say you want something simpler and skip the use of task. If you
have an sType called mystuff/manager that already contains an email
address or comma separated email addresses in an attribute called email,
you may want to email to the dedicated manager for a paricular shot.
Assuming your shot sType mystuff/shot and mystuff/manager has a schema
connection already, you can email them when updating your shot with the
event update|mystuff/shot.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>@GET(sobject.mystuff/manager.email)</code></pre>
</div></div>
<div class="paragraph"><p>If you want to email to the same manager David and a person named Carin
defined in Users when updating any shots with the event
update|mystuff/shot, there is no need to start off with the variable
sobject representing the shot in transaction.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>@GET(mystuff/manager['first_name']['David'].email)
@GET(sthpw/login['first_name']['Carin'].email)</code></pre>
</div></div>
<div class="paragraph"><p>For example, send to the user related to this sObject as well as the
user <em>john</em>. If the event is insert|sthpw/note, it will be the person
who enters the note. If the event is <em>update|sthpw/task</em>, the person is
the assignee of the task:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>@UNION(@SOBJECT(sthpw/login['login', 'john']), @SOBJECT(sobject.sthpw/login))</code></pre>
</div></div>
<div class="paragraph"><p>To make these mail_to expressions more readable, put more than 1
expression or email addresses on multiple lines. There is no need for
@UNION. @GET can even be used to just get to the list of login names.</p></div>
<div class="paragraph"><p>For example, to send to everyone in the supervisor group, the assignee
of a task, to all the users in the <strong>mangers</strong> group and the email address
<a href="mailto:support@southpawtech.com">support@southpawtech.com</a>, enter 3 lines under mail_to:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>@SOBJECT(sobject.sthpw/login)
@GET(sthpw/login_in_group['login_group','supervisor'].login)
managers
support@southpawtech.com</code></pre>
</div></div>
<div class="paragraph"><p><strong>More on Expressions in Notifications</strong></p></div>
<div class="paragraph"><p>The word "sobject" often appears in the <em>Mail to:</em> column but not in
Message or Subject. This is because the implementation allows sending
notifications to users related to the current sObject or just about
anyone not necessarily related to the current sObject. As illustrated
above, @SOBJECT(sobject.sthpw/login) is the task assignee but the users
under the group supervisor is not related to this task and so the
keyword "sobject" is not used. In the Message area, to refer to the
current sObject status (task status if the event is update|sthpw/task),
just use an @GET(.status), as the sobject is always assumed to be in
this context.</p></div>
<div class="paragraph"><p><strong>Task related notification</strong></p></div>
<div class="paragraph"><p>To establish the relationship between the login search type and task
search type, the following built-in schema line is used. It is not
necessary to add it to the schema. It can be used as an example to
create a custom search_type.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;connect to='sthpw/task' relationship='code' from_col='login' from='sthpw/login' to_col='assigned'/&gt;</code></pre>
</div></div>
<div class="paragraph"><p><strong>Note related notification</strong></p></div>
<div class="paragraph"><p>To establish the relationship between the login search type and note
search type, the following built-in schema line is used. It is not
necessary to add it to the schema. It can be used as an example to
create a custom search_type and to edit the schema.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;connect to='sthpw/note' relationship='code' from_col='login' from='sthpw/login' to_col='login'/&gt;</code></pre>
</div></div>
<div class="paragraph"><p>Sending a notification to the person who just entered the note is not
often used. Instead, an email handler can be used in this situation to
send to the supervisor and assignee of the task under the same context.
A built-in email handler is called "pyasm.command.NoteEmailHandler".
Instead of entering it into an expression for <em>mail_to</em>, enter it into
the <em>email_handler_class</em> field.</p></div>
<div class="paragraph"><p><strong>Email Test</strong></p></div>
<div class="paragraph"><p><span class="image">
<img src="media/2_advanced_notification_email_test.png" alt="image" />
</span></p></div>
<div class="paragraph"><p>Once the fields <em>event</em>, <em>mail_to</em>, and <em>message</em> are properly filled
in, to test the email, click on the <strong>Email Test</strong> button. It catches
syntax errors or typos in expression in these fields as well as
reporting any email server error if the service section of the TACTIC
config file has not been properly filled in. Settings like firewall and
TLS settings may also block an email from being sent out.</p></div>
<div class="paragraph"><p><strong>Example 1:</strong></p></div>
<div class="paragraph"><p>In this example, the notification will be sent out each time a ticket is
updated. It will also only send to users in the <em>admin</em> and <em>moderator</em>
groups.</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="17%" />
<col width="83%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><strong>Event</strong></p></td>
<td align="left" valign="top"><p class="table">update|support/ticket</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Description</strong></p></td>
<td align="left" valign="top"><p class="table">Sent when tickets are updated</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Subject</strong></p></td>
<td align="left" valign="top"><p class="table"><span class="image">
<img src="media/multiline_message.png" alt="image" />
</span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Message</strong></p></td>
<td align="left" valign="top"><p class="table">[multiblock cell omitted]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>mail_to</strong></p></td>
<td align="left" valign="top"><p class="table">admin , <a href="mailto:user@gmail">user@gmail</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Rules</strong></p></td>
<td align="left" valign="top"><p class="table">[multiblock cell omitted]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Email Handler Class</strong></p></td>
<td align="left" valign="top"><p class="table">[multiblock cell omitted]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Project Code</strong></p></td>
<td align="left" valign="top"><p class="table">support</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Type</strong></p></td>
<td align="left" valign="top"><p class="table">email</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p><strong>Example 2:</strong></p></div>
<div class="paragraph"><p>In this example, the notification will be sent out each time a
shot-based note is updated. It will send to manager&#8217;s group and everyone
assigned to the tasks of the shot. Since project_code is left empty,
this works across all the projects in the system.</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="17%" />
<col width="83%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><strong>Event</strong></p></td>
<td align="left" valign="top"><p class="table">insert|sthpw/note</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Description</strong></p></td>
<td align="left" valign="top"><p class="table">Sent when shot-based notes are added</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Subject</strong></p></td>
<td align="left" valign="top"><p class="table">{$PROJECT} {@GET(parent.sequence_code)} - {@GET(parent.code)} {@GET(.process)}</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Message</strong></p></td>
<td align="left" valign="top"><p class="table"><span class="image">
<img src="media/message_2.png" alt="image" />
</span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Rules</strong></p></td>
<td align="left" valign="top"><p class="table"><span class="image">
<img src="media/rules.png" alt="image" />
</span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Email Handler Class</strong></p></td>
<td align="left" valign="top"><p class="table">[multiblock cell omitted]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Project Code</strong></p></td>
<td align="left" valign="top"><p class="table">[multiblock cell omitted]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Type</strong></p></td>
<td align="left" valign="top"><p class="table">email</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>mail_to</strong></p></td>
<td align="left" valign="top"><p class="table"><span class="image">
<img src="media/mail_to.png" alt="image" />
</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p><strong>Example 3:</strong></p></div>
<div class="paragraph"><p>In this example, the notification will be sent out each time a note is
added. It also allows users to have their own Email Message Template and
preserve its html format.</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="17%" />
<col width="83%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><strong>Event</strong></p></td>
<td align="left" valign="top"><p class="table">insert|sthpw/note</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Description</strong></p></td>
<td align="left" valign="top"><p class="table">Sent when new note is added</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Subject</strong></p></td>
<td align="left" valign="top"><p class="table">TACTIC: a new note has been added.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Message</strong></p></td>
<td align="left" valign="top"><p class="table"><span class="image">
<img src="media/message_3.png" alt="image" />
</span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Rules</strong></p></td>
<td align="left" valign="top"><p class="table">[multiblock cell omitted]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Email Handler Class</strong></p></td>
<td align="left" valign="top"><p class="table">[multiblock cell omitted]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Project Code</strong></p></td>
<td align="left" valign="top"><p class="table">[multiblock cell omitted]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>Type</strong></p></td>
<td align="left" valign="top"><p class="table">email</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><strong>mail_to</strong></p></td>
<td align="left" valign="top"><p class="table">admin, <a href="mailto:user@gmail.com">user@gmail.com</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p><span class="image">
<img src="media/3_advanced_notification_setup_overview.png" alt="Sample HTML Message" />
</span></p></div>
<div class="paragraph"><p><strong>Notification Expressions</strong></p></div>
<div class="paragraph"><p>TACTIC uses the TACTIC Expression Language to build dynamic Notification
Subject and Message contents. This allows for each notification to be
sent based on properties from the Search Objects it is being sent for.</p></div>
<div class="paragraph"><p>In the simple example Subject below, the "id" property is used from the
"ticket" search object.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>TACTIC Ticket {$GET(.id)} has been updated</code></pre>
</div></div>
<div class="paragraph"><p>The expected results of this would be similar to the following:</p></div>
<div class="paragraph"><p>"TACTIC Ticket 14 has been updated"</p></div>
<div class="paragraph"><p><strong>Example 1</strong></p></div>
<div class="paragraph"><p>In essence, anything between the curly brackets "{}" is evaluated as an
expression by TACTIC.</p></div>
<div class="quoteblock">
<div class="content">
<div class="paragraph"><p><strong>Note</strong></p></div>
<div class="paragraph"><p>For more information regarding TACTIC Expression Language please refer
to the <strong>TACTIC Expression Language</strong> docs</p></div>
</div>
<div class="attribution">
</div></div>
<div class="paragraph"><p><strong>Filtering Notifications</strong></p></div>
<div class="paragraph"><p>TACTIC&#8217;s notification architecture is a rules-based system built using
the trigger architecture. Every time a command is executed, TACTIC looks
through the list of defined triggers (including notifications) for a
match. Under the <strong>Triggers</strong> view will be an entry for the EmailTrigger
class that is registered under the "email" event. It is possible to
create custom Email Trigger handlers in that view.</p></div>
<div class="paragraph"><p>There are 3 main criteria used to filter out notifications:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>group</strong>: Filters out notifications to be sent only to users in the
included groups.
</p>
</li>
<li>
<p>
<strong>project</strong>: Filters out notifications so that only a certain project
can fire the email trigger.
</p>
</li>
<li>
<p>
<strong>rules</strong>: Rules are an XML snippet which can finely control the
conditions when an email trigger may be fired.
</p>
</li>
</ul></div>
<div class="paragraph"><p><strong>Groups</strong></p></div>
<div class="paragraph"><p>By planning groups to send notifications to, it allows for simple
connections for deciphering which groups of users will receive
notifications when the conditions of a particular notification rule are
met. Once a notification has been created, it can be associated with any
number of groups of users. All users in this group will then be sent a
notification when the rule is triggered.</p></div>
<div class="paragraph"><p>The Groups view can be found under:</p></div>
<div class="paragraph"><p><strong>Admin&#8594;Site Admin &#8594;Groups</strong></p></div>
<div class="paragraph"><p>To specify a group to send a notification to, specify the group in the
<strong>mail_to</strong> column.</p></div>
<div class="paragraph"><p><strong>Project</strong></p></div>
<div class="paragraph"><p>By setting the project in the project column of a Notification, TACTIC
will only use the notification trigger for the chosen project.</p></div>
<div class="paragraph"><p><strong>Access Rules</strong></p></div>
<div class="paragraph"><p>When a notification rule has passed all of the criteria, a message is
constructed. Most email events occur after a command has been completed.
The email handler then takes the information from the command and
creates a default message to be sent to the appropriate people.</p></div>
<div class="paragraph"><p>All rules are contained in groups. For notifications, there are a few
predefined groups:</p></div>
<div class="paragraph"><p><strong>Example 1</strong></p></div>
<div class="paragraph"><p>This rule group only allows tasks for prod/asset for the project
sample3d to send out notification. Otherwise, it would send out
notifications for tasks of all search types</p></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;rules&gt;
   &lt;rule&gt;@GET(.search_type)=='prod/asset?project=sample3d'&lt;/rule&gt;
&lt;/rules&gt;</code></pre>
</div></div>
<div class="paragraph"><p><strong>Example 2</strong></p></div>
<div class="paragraph"><p>This rule group makes use of a key/value pair of attributes: that is,
when the attribute with the value of "key" is equal to "value", the rule
is passed. In the example below, all SObjects containing the attribute
"context" with the value "client" are triggered.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> (deprecated)

&lt;rules&gt;
    &lt;rule group="SObject" key="context" value="client"/&gt;
&lt;/rules&gt;</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;rules&gt;
    &lt;rule&gt;@GET(.context)=='client'&lt;/rule&gt;
&lt;/rules&gt;</code></pre>
</div></div>
<div class="paragraph"><p><strong>Example 3</strong></p></div>
<div class="paragraph"><p>For certain SObjects in TACTIC (like tasks), parent attributes can be
used for constructing rules. The concept behind this is the same as
group="sObject", but now we are referring to the parent of a task (for
example, a 3D asset). This notification will only be sent if the task&#8217;s
parent, a 3D asset, is categorized under the "prp" asset library.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;!-- DEPRICATED --&gt;
&lt;rules&gt;
    &lt;rule group='parent' key='asset_library' value='prp'/&gt;
&lt;/rules&gt;</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;rules&gt;
    &lt;rule&gt;@GET(prod/asset.asset_library)=='prp'&lt;rule&gt;
&lt;/rules&gt;</code></pre>
</div></div>
<div class="paragraph"><p><strong>Example 4</strong></p></div>
<div class="paragraph"><p>For notes in TACTIC, we may have 2 processes for notes (e.g. anim,
anim_2) We can check if the process partially contains the word <strong>anim</strong>
by the following:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;rules&gt;
    &lt;rule&gt;'anim' in @GET(.process)&lt;rule&gt;
&lt;/rules&gt;</code></pre>
</div></div>
<div class="paragraph"><p>Note: list comparisons like @GET(.process) in [<em>anim</em>,<em>anim_2</em>] are not
supported</p></div>
<div class="paragraph"><p><strong>Example 5</strong></p></div>
<div class="paragraph"><p>For a check-in notification in TACTIC, we can choose to send only if the
is_current attribute is True for the event insert|sthpw/snapshot by the
following:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;rules&gt;
    &lt;rule&gt;@GET(.is_current)==True&lt;rule&gt;
&lt;/rules&gt;</code></pre>
</div></div>
<div class="paragraph"><p><strong>Email Handler Class</strong></p></div>
<div class="paragraph"><p>Each time a notification is executed, TACITC uses either the default
email handler or it uses and email handler override defined by the Email
Handler Class property for the notification.</p></div>
<div class="paragraph"><p>The Email Handler Class digs deeply into the structure of the
notifications using Python and the TACTIC client API. It is only needed
for very specific rules which determine when a notification is sent.</p></div>
<div class="paragraph"><p>An example override is shown below:</p></div>
<div class="paragraph"><p><strong>Email Hander Cls:</strong> sites.support.email.TicketEmailHandler</p></div>
<div class="listingblock">
<div class="content">
<pre><code>__all__ = ['TicketEmailHandler']

from pyasm.common import Environment, Xml, Date
from pyasm.security import Login
from pyasm.search import Search
from pyasm.biz import GroupNotification, Pipeline, Task, Snapshot, File, Note


class TicketEmailHandler(object):
    '''Email sent when a ticket is updated'''

    def __init__(my, notification, SObject, parent, command):
        my.notification = notification
        my.sobject = SObject
        my.command = command
        my.parent = parent

    def check_rule(my):
        '''determine whether an email should be sent'''
        return True

    def get_to(my):

        ticket = my.sobject
        user = ticket.get_value("login")
        login = Login.get_by_login(user)
        recipients = []
        recipients.append(login)

        return recipients


    def get_cc(my):

        admin = Login.get_by_login("admin")
        recipients = []
        recipients.append(admin)

        return recipients


    def get_subject(my):

        ticket = my.sobject
        title = "Ticket Number: "
        id = ticket.get_value("id")

        return "%s%s"  % (title, id)


    def get_message(my):

        ticket = my.sobject
        id = ticket.get_value("id")
        subject = ticket.get_value("subject")
        summary = ticket.get_value("summary")
        status = ticket.get_value("status")

        msg = []
        msg.append("Ticket: %s" % id)
        msg.append("")
        msg.append("Status: %s" % status)
        msg.append("")
        msg.append("subject: %s" % subject)
        msg.append("Summary: %s" % summary)
        msg.append("")

        return "\n".join(msg)</code></pre>
</div></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2016-06-17 16:33:33 EDT
</div>
</div>
</body>
</html>
